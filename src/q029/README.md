# Q29.[Crypto] Common World

RSAでは、

> 暗号文 = 平文^E mod N

である。

この問題では、暗号文と E, N の組が2つ与えられる。それぞれ (Y1, E1, N1), (Y2, E2, N2) とし、求める平文を X とする。

よく見ると N1 == N2 であることに気づくので、 N1 = N2 = N とおく。 RSA の定義から、

```
X^E1 = Y1 mod N
X^E2 = Y2 mod N
```

である。いろいろ試しているうちに Y2 が Y1 で割り切れることに気づき、さらに、 `gcd(Y1, N)` を計算してみると Y1 と N が互いに素であるとわかる。以上より、 `Y2 / Y1 = P` とすると、

```
Y1 X^(E2 - E1) = Y2 mod N
X^(E2 - E1) = P mod N
X^2 = P + k * N (k は非負整数)
```

と式変形できる。実は今回は k = 0 で上の式が成り立ってしまう。

今回みたいな大きい整数の計算は多倍長整数をサポートしている python, ruby, java などで計算するといい。

```
cpaw{424311244315114354}
```
